# Ubparse

### Инструмент считывания и обработки конфигурационных файлов linux-систем, позволяет парсить конфигурационные файлы и выводить их в файл с измененной структурой.
#### Вывод обработки (структура) задаётся файлами шаблонов, в которых описаны правила преобразования.

Состав:
1. Папка /out - хранение шаблонов вывода парсинга программы;
2. Папка /parse - хранение шаблонов парсинга конфигурационных файлов;
3. Файл ubparse.sh - оновной исполняемый скрипт, которому передаются параметры парсинга.

***Структура файла формата вывода format.out (из каталога /out):***

```Set key = value  
Block \\ntype:name\\n{  
End }\\n  
BeginGroup [name]\\n(\\n  value  
ValueGroup 	\\0 value  
EndGroup )  
```
Где,  
**Set** - задание одиночной записи в конфигурации;  
**key** - ключ;  
**value** - значение ключа;  
**Block** - задание записи блока в конфигурации;  
**type** - тип блока;  
**name** - блока;  
**End** - запись конца блочной записи;  
**BeginGroup** - начало записи группы записей конфигурации;  
**[name]** - имя группы записей конфигурации;  
**value** - значение ключа группы записей конфигурации;  
**ValueGroup** - значение ключей объединенной группы из ключа, указанного в значении value BeginGroup;  
**EndGroup** - запись конца записи группы.  

***Структура файла шаблона для парсинга apache (из каталога /parse):***  
```
Patch /etc/httpd/conf/httpd.conf  
IncludePath /etc/httpd/  
Comment ^#\s?  
Off ^#\\S  
Block IF ^<IfModule\\s?(.+)>$ </IfModule>  
Block De ^<Directory\\s?(.+)>$ </Directory>  
Block File ^<Files\\s?(.+)>$ </Files>  
Block Fi ^<FilesMatch\\s?"(.+)">$ </FilesMatch>  
Group LoadModule  
Group ErrorDocument  
Group AddIcon  
Group AddIconByType  
Group AddLanguage  
Group AddCharset  
Group ProxyHTMLLinks  
DInclude Include  
Set ^([a-Z]+)\\s(.+)  
```
Где,  
**Patch** - путь до конфигурационного файла, который будет обрабатываться парсером;  
**IncludePath** - путь до дочерних конфигураций программы, которые будут обрабатываться парсером;  
**Comment** - регулярное выражение для обозначения комментариев (описание) в конфигурационных файлах;  
**Off** - регулярное выражение для обозначения комментариев (значений и параметров) в конфигурационных файлах;  
**Block** - регулярное выражене для обозначения начала и конца блока в конфигурационных файлах;  
**IF, De, File, Fi** - произвольгные миена идентификаторов для Block;  
**Group** - задание директив в конфигурационных файлах для объединения в группы;  
**DInclude** - задание вида директивы include;  
**Set** - задание регулярного выражения для парсинга строки (не блочной записи) в конфигурационных файлах.  

***Параметры запуска парсера***  
ubparse.sh -ключ имя_шаблона_парсинга  
ключи:  
**r** - фильтр по уровню вложенности, числовой параметр;  
**n** - фильтр по имени блока, строковый параметр;  
**t** - фильтр по типу записи, строковый параметр;  
**k** - фильтр по имени ключа, строковый параметр;  
**l** - список блоков, без параметра;  
**f** - форматированный вывод, без параметра;  
**q** - вывод с номерами строк, без параметра;  
**e** - режим отладки, без параметра;  
**s** - вывод в режиме "как есть";  
**w** - вывод формата идентификации шаблона, дополнение режиму отладки;  
**z** - установка лимита парсинга, числовое значение (обработка количества строк).  

*Например, ubparse.sh -q apache выведет обработанный конфигурационный файл /etc/httpd/conf/httpd.conf в консоль с номерами строк.*
